import RPi.GPIO as GPIO
import sys, tty, termios, signal

inputs = [16,20]

def interrupted(signum,frame):
  for x in inputs:
    GPIO.output(x,GPIO.LOW)

old_settings = termios.tcgetattr(sys.stdin.fileno()) #records current terminal settings
signal.signal(signal.SIGALRM, interrupted) #calls interrupted when alarm stops
tty.setraw(sys.stdin.fileno()) #raw keystroke input, changes terminal settings

GPIO.setmode(GPIO.BCM)
GPIO.setup(16,GPIO.OUT)
GPIO.setup(20,GPIO.OUT)
GPIO.output(16,GPIO.LOW)
GPIO.output(20,GPIO.LOW)

print("\n")
print("q-quit 1-up 2-down")
print("\n")

while True:
  
  signal.setitimer(signal.ITIMER_REAL,0.155) #starts alarm for 0.155 sec
  ch = sys.stdin.read(1) #saves one keystroke as variable
  signal.setitimer(signal.ITIMER_REAL,0) #resets alarm and ch variable
  
  if ch == 'q': #press q to quit
    GPIO.cleanup()
    termios.tcsetattr(sys.stdin.fileno(), termios.TCSADRAIN, old_settings) #Changes the terminal settings back to what they were before
    break
    
  elif ch == '1': #press 1 to go up
    GPIO.output(16,GPIO.HIGH)
    GPIO.output(20,GPIO.LOW)
    
  elif ch == '2': #press 2 to go down
    GPIO.output(16,GPIO.LOW)
    GPIO.output(20,GPIO.HIGH)
